!function(a,s){"use strict";var i="plmultiselect";function n(t,e){this.$el=a(t),this.options=a.extend({},e),this.$search=this.options.inputSearch,this.$left=this.options.ulAvailable,this.$right=this.options.ulSelected,this.$spinner=this.options.spinner,this.doingAjax=!1,this.init()}n.prototype={init:function(){var e=this;this.$right.height(this.$left.parent().height()),this.$search.autocomplete({minLength:0,source:function(t){e.queryItems(t.term,0,function(t){e.renderMenu(e.$left,t.data)})},create:function(){a(this).autocomplete("search")}}),this.$left.on("click","> li",function(){a(this).is(".selected")||e.selectItem.call(e,a(this))}),this.$right.on("click","> li .dashicons-no",function(){var t=a(this).closest("li").data("ID");a(this).closest("li").remove(),e.$left.find(".post-"+t).removeClass("selected")}),this.options.selected.length&&this.selectItem(this.options.selected),this.$left.on("scroll",function(){this.scrollHeight-a(this).scrollTop()-15<=a(this).height()&&e.nextPage()})},nextPage:function(){var e=this,t=this.options.inputSearch.val(),i=this.$left.children("li").length;this.queryItems(t,i,function(t){e.renderMenu(e.$left,t.data,"",!0)})},queryItems:function(t,e,i){if(this.doingAjax)return!1;this.doingAjax=!0,this.$spinner.addClass("is-active"),a.ajax({url:s.ajaxurl,type:"GET",data:{action:this.options.ajaxAction,term:t,offset:e},context:this,success:function(t){a.isFunction(i)&&i.call(this,t)},complete:function(){this.doingAjax=!1,this.$spinner.removeClass("is-active")}})},selectItem:function(t){var e=this.options.inputName;a.isArray(t)?this.renderMenu(this.$right,t,e,!0):(e+="["+t.data("ID")+"]",t.clone(!1).data("ID",t.data("ID")).appendTo(this.$right).find("input.post-id").attr("name",e),t.addClass("selected"))},renderMenu:function(t,e,i,s){var n=this,l=[];s||t.empty(),a.each(e,function(t,e){l.push(n.getItemTpl(e,i+"["+e.ID+"]"))}),t.append(l)},getItemTpl:function(t,e){e=e||"";var i=a("<li />").addClass("post-"+t.ID).data("ID",t.ID).append('<span class="post-title">'+t.post_title+'</span><span class="dashicons dashicons-no" title="Remove"></span><span class="post-type">'+t.post_type+'</span><input type="hidden" class="post-id" name="'+e+'" value="'+t.ID+'" />');return this.$right.find(".post-"+t.ID).length&&i.addClass("selected"),i}},a.fn[i]=function(e){return this.each(function(){var t=a(this).data(i+".plugin");t||(t=new n(this,e),a(this).data(i+".plugin",t))})}}(jQuery,window),function(i){"use strict";i(function(){i(".pl-posts-container").each(function(){var t=i(this).find(".pl-posts-selected .pl-multiselect").data("key"),e=i(this).find(".pl-posts-selected .pl-multiselect").data("input_name");i(this).plmultiselect({ajaxAction:"pl_autocomplete",inputName:e,inputSearch:i(this).find(".pl-autocomplete"),ulAvailable:i(this).find(".pl-posts-available .pl-multiselect"),ulSelected:i(this).find(".pl-posts-selected .pl-multiselect"),selected:window.postlockdown[t]||[],spinner:i(this).find(".spinner")})})})}(jQuery);