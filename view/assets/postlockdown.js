(function(){"use strict";/*!
	jquery-plmultiselect v1.0.2
	A jQuery multi select plugin for WordPress admin
	(c) 2015 Andy Palmer
	license: http://www.gnu.org/licenses/gpl-2.0.html
*/(function(e,o){var n="plmultiselect";function a(t,i){this.$el=e(t),this.options=e.extend({},i),this.$search=this.options.inputSearch,this.$left=this.options.ulAvailable,this.$right=this.options.ulSelected,this.$spinner=this.options.spinner,this.doingAjax=!1,this.init()}a.prototype={init:function(){var t=this;this.$right.height(this.$left.parent().height()),this.$search.autocomplete({minLength:0,source:function(i){t.queryItems(i.term,0,function(s){t.renderMenu(t.$left,s.data)})},create:function(){e(this).autocomplete("search")}}),this.$left.on("click","> li",function(){e(this).is(".selected")||t.selectItem.call(t,e(this))}),this.$right.on("click","> li .dashicons-no",function(){var i=e(this).closest("li").data("ID");e(this).closest("li").remove(),t.$left.find(".post-"+i).removeClass("selected")}),this.options.selected.length&&this.selectItem(this.options.selected),this.$left.on("scroll",function(){this.scrollHeight-e(this).scrollTop()-15<=e(this).height()&&t.nextPage()})},nextPage:function(){var t=this,i=this.options.inputSearch.val(),s=this.$left.children("li").length;this.queryItems(i,s,function(l){t.renderMenu(t.$left,l.data,"",!0)})},queryItems:function(t,i,s){if(this.doingAjax)return!1;this.doingAjax=!0,this.$spinner.addClass("is-active"),e.ajax({url:o.ajaxurl,type:"GET",data:{action:this.options.ajaxAction,term:t,offset:i,_ajax_nonce:this.options.ajaxNonce},context:this,success:function(l){e.isFunction(s)&&s.call(this,l)},complete:function(){this.doingAjax=!1,this.$spinner.removeClass("is-active")}})},selectItem:function(t){var i=this.options.inputName;e.isArray(t)?this.renderMenu(this.$right,t,i,!0):(i+="["+t.data("ID")+"]",t.clone(!1).data("ID",t.data("ID")).appendTo(this.$right).find("input.post-id").attr("name",i),t.addClass("selected"))},renderMenu:function(t,i,s,l){var p=this,c=[];l||t.empty(),e.each(i,function(u,h){c.push(p.getItemTpl(h,s+"["+h.ID+"]"))}),t.append(c)},getItemTpl:function(t,i){i||(i="");var s=e("<li />").addClass("post-"+t.ID).data("ID",t.ID).append('<span class="post-title">'+t.post_title+'</span><span class="dashicons dashicons-no" title="Remove"></span><span class="post-type">'+t.post_type+'</span><input type="hidden" class="post-id" name="'+i+'" value="'+t.ID+'" />');return this.$right.find(".post-"+t.ID).length&&s.addClass("selected"),s}},e.fn[n]=function(t){return this.each(function(){var i=e(this).data(n+".plugin");i||(i=new a(this,t),e(this).data(n+".plugin",i))})}})(jQuery,window),function(e){e(function(){e(".pl-posts-container").each(function(){var o=e(this).find(".pl-posts-selected .pl-multiselect").data("key"),n=e(this).find(".pl-posts-selected .pl-multiselect").data("input_name"),a=e(this).closest("table.form-table");e(this).plmultiselect({ajaxAction:a.data("ajax_action"),ajaxNonce:a.data("ajax_nonce"),inputName:n,inputSearch:e(this).find(".pl-autocomplete"),ulAvailable:e(this).find(".pl-posts-available .pl-multiselect"),ulSelected:e(this).find(".pl-posts-selected .pl-multiselect"),selected:window.postlockdown[o]||[],spinner:e(this).find(".spinner")})})})}(jQuery)})();
